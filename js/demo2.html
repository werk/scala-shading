<!DOCTYPE html>
<html style="margin: 0;">
    <head>
        <meta charset="utf-8">
        <title>WebGL - Time travelling demo</title>
        <script src="animade.js"></script>
        <script id="2d-fragment-shader" type="x-shader/x-fragment">//<![CDATA[
            vec4 hsvaToRgba(vec4 c) {
                vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
                vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);
                vec3 r = c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);
                return vec4(r, c.a);
            }
			
            vec4 animation(vec4 position) {
                float pi = 3.141592653589793;
                float t = position.w;
                float x = position.x;
                float y = position.y;
                float v0 = sqrt((pow((0.0 - (cos((0.7 * t)) + x)), 2.0) + pow((0.0 - (sin((0.7 * t)) + y)), 2.0)));
                float v1 = (((1.0 / sqrt(0.3)) * sqrt((2.0 * pi))) * exp((-((0.0 * 0.0) / pow((2.0 * 0.3), 2.0)))));
                float v2 = ((((1.0 / sqrt(0.3)) * sqrt((2.0 * pi))) * exp((-((v0 * v0) / pow((2.0 * 0.3), 2.0))))) / v1);
                vec4 v3 = vec4(v2, v2, v2, 1.0);
                vec4 v4 = vec4(0.0, 0.0, 5.0, 1.0);
                vec4 v5 = vec4((v3.x * v4.x), (v3.y * v4.y), (v3.z * v4.z), v3.w);
                float v6 = v5.x;
                float v7 = v5.y;
                float v8 = v5.z;
                float v9 = v5.w;
                vec4 v10 = hsvaToRgba(vec4(mod((((1.0 * (t + (v8 * v9))) + (x + (v6 * v9))) / 10.0), 1.0), 0.8, 0.5, 1.0));
                float v11 = (1.0 - abs((((0.0 * (t + (v8 * v9))) + (y + (v7 * v9))) - sin(((1.0 * (t + (v8 * v9))) + (x + (v6 * v9)))))));
                vec4 v12 = vec4(v11, v11, v11, 1.0);
                vec4 v13 = vec4((v10.x * v12.x), (v10.y * v12.y), (v10.z * v12.z), v10.w);
                float v14 = sqrt((pow((0.0 - (cos((1.0 * (t + (v8 * v9)))) + (x + (v6 * v9)))), 2.0) + pow((0.0 - (sin((1.0 * (t + (v8 * v9)))) + (y + (v7 * v9)))), 2.0)));
                float v15 = (((1.0 / sqrt(0.3)) * sqrt((2.0 * pi))) * exp((-((0.0 * 0.0) / pow((2.0 * 0.3), 2.0)))));
                float v16 = ((((1.0 / sqrt(0.3)) * sqrt((2.0 * pi))) * exp((-((v14 * v14) / pow((2.0 * 0.3), 2.0))))) / v15);
                vec4 v17 = vec4(v16, v16, v16, 1.0);
                float v18 = sqrt((pow((0.0 - (cos((1.0 * ((t + (v8 * v9)) + ((2.0 * pi) / 3.0)))) + (x + (v6 * v9)))), 2.0) + pow((0.0 - (sin((1.0 * ((t + (v8 * v9)) + ((2.0 * pi) / 3.0)))) + (y + (v7 * v9)))), 2.0)));
                float v19 = (((1.0 / sqrt(0.3)) * sqrt((2.0 * pi))) * exp((-((0.0 * 0.0) / pow((2.0 * 0.3), 2.0)))));
                float v20 = ((((1.0 / sqrt(0.3)) * sqrt((2.0 * pi))) * exp((-((v18 * v18) / pow((2.0 * 0.3), 2.0))))) / v19);
                vec4 v21 = vec4(v20, v20, v20, 1.0);
                vec4 v22 = vec4(min(1.0, (v17.x + v21.x)), min(1.0, (v17.y + v21.y)), min(1.0, (v17.z + v21.z)), v17.w);
                float v23 = sqrt((pow((0.0 - (cos((1.0 * ((t + (v8 * v9)) + ((4.0 * pi) / 3.0)))) + (x + (v6 * v9)))), 2.0) + pow((0.0 - (sin((1.0 * ((t + (v8 * v9)) + ((4.0 * pi) / 3.0)))) + (y + (v7 * v9)))), 2.0)));
                float v24 = (((1.0 / sqrt(0.3)) * sqrt((2.0 * pi))) * exp((-((0.0 * 0.0) / pow((2.0 * 0.3), 2.0)))));
                float v25 = ((((1.0 / sqrt(0.3)) * sqrt((2.0 * pi))) * exp((-((v23 * v23) / pow((2.0 * 0.3), 2.0))))) / v24);
                vec4 v26 = vec4(v25, v25, v25, 1.0);
                vec4 v27 = vec4(min(1.0, (v22.x + v26.x)), min(1.0, (v22.y + v26.y)), min(1.0, (v22.z + v26.z)), v22.w);
                return vec4(min(1.0, (v13.x + v27.x)), min(1.0, (v13.y + v27.y)), min(1.0, (v13.z + v27.z)), v13.w);
            }
        //]]></script>
    </head>
    <body style="margin: 0; overflow: hidden;">
        <canvas id="canvas" width="16" height="16"></canvas>
        <script>
            var animade = new Animade({
                canvas: document.getElementById('canvas'), 
                source: document.getElementById('2d-fragment-shader').text
            });

            window.onresize = function() { animade.resize(window.innerWidth, window.innerHeight); };
            window.onresize();

            var start = Date.now();
            function step() {
                animade.draw({u_time: (Date.now() - start) / 1000});
                requestAnimationFrame(step);
            }
            step();
        </script>
    </body>
</html>
